import{_ as $,r as C,a as ee,o as u,c as h,b as l,d as e,w as o,u as t,I as G,e as I,f as T,g as v,h as H,v as te,i as x,t as V,j as F,F as A,k as J,l as R,m as le,n as P,p as oe,q as B,s as U,x as N,y as X,z as ne,A as se,B as ae,C as ie,D as ce,E as de,G as K,H as ue,J as re}from"./index-b713903c.js";const p=c=>(B("data-v-e2e28217"),c=c(),U(),c),pe={id:"page"},_e={class:"questionContainer"},he=p(()=>l("h2",null," Create Poll ",-1)),fe=["src"],ye=p(()=>l("br",null,null,-1)),ve=p(()=>l("h2",null,"Button Text",-1)),me=p(()=>l("br",null,null,-1)),be=p(()=>l("br",null,null,-1)),ge=p(()=>l("h1",null,"Send with notification",-1)),ke=["onClick"],we=["onClick"],Se=["onClick"],Ce=p(()=>l("br",null,null,-1)),xe=p(()=>l("br",null,null,-1)),Ie=p(()=>l("br",null,null,-1)),Te=["onUpdate:modelValue"],Pe=p(()=>l("option",{value:"text"},"Text",-1)),Ve=p(()=>l("option",{value:"radio"},"Radio",-1)),$e=p(()=>l("option",{value:"checkbox"},"Checkbox",-1)),Oe=p(()=>l("option",{value:"short"},"Short Response",-1)),qe=p(()=>l("option",{value:"long"},"Long Response",-1)),Ne=[Pe,Ve,$e,Oe,qe],Ae={key:1,style:{"background-color":"white",width:"80%",height:"3px"}},Re={style:{display:"flex","flex-direction":"row"}},De=["onClick"],Ee=["onClick"],Je=p(()=>l("br",null,null,-1)),Be=p(()=>l("br",null,null,-1)),Ue=p(()=>l("br",null,null,-1)),Le=p(()=>l("br",null,null,-1)),Me={__name:"PollCreator",setup(c){const r=C("");C({});const n=C([]),d=C(!1),_=C(0);function m(){n.value.push({title:"",options:[]})}function b(i){const a=n.value.indexOf(i);n.value.splice(a,1)}function g(i){i.options.push({title:""})}function k(i,a){i.options.splice(i.options.indexOf(a),1)}function w(){const i=document.querySelectorAll("#title")[0].value,a=document.querySelectorAll("#desc")[0].value,S=document.querySelectorAll("#button")[0].value;if(!confirm("Are you sure you want to create poll "+i+"?"))return;const s=document.querySelectorAll(".question"),f=[];s.forEach(y=>{const q=y.querySelectorAll("ion-input")[0].value,Y=y.querySelectorAll("select")[0].value;let E;y.querySelectorAll(".required").length>0?E=y.querySelectorAll(".required")[0].checked:E=!1;const Z=[].slice.call(y.querySelectorAll("ion-input")).splice(1),z=[];Z.forEach(Q=>{z.push(Q.value)}),f.push({title:q,type:Y,choices:z,required:E})}),console.log("Creating "+i+" with description "+a+" and button "+S),console.log(JSON.stringify(f)),d.value?fetch("/scheduleaction",{method:"POST",body:JSON.stringify({endpoint:"polls",body:JSON.stringify({timestamp:new Date().getTime()/1e3,title:i,desc:a,button:S,disabled:!1,polldata:JSON.stringify({poll:f}),image:r.value,key:localStorage.getItem("key")}),time:new Date(_.value).getTime()})}):fetch("https://greencanyonapp.com/api/polls",{method:"POST",body:JSON.stringify({timestamp:new Date().getTime()/1e3,title:i,desc:a,button:S,disabled:!1,polldata:JSON.stringify({poll:f}),image:r.value,key:localStorage.getItem("key")}),headers:{"Content-Type":"application/json"}}).then(q=>{if(!q.ok){alert("There was an error creating poll. Are you sure you have a key saved?");return}location.reload(),alert("Poll created!")}).catch(q=>{alert("An unknown error occurred.")});const D=document.querySelectorAll("#allnotif")[0].checked,L=document.querySelectorAll("#gamesnotif")[0].checked,M=document.querySelectorAll("#eventsnotif")[0].checked,j=document.querySelectorAll("#schedulenotif")[0].checked;if(D||L||M||j){let y="";D&&(y="all"),L&&(y="game"),M&&(y="event"),j&&(y="schedule"),console.log("Sending notification to "+y),d.value?fetch("/scheduleaction",{method:"POST",body:JSON.stringify({endpoint:"notification",body:JSON.stringify({topic:y,title:"New poll!",body:"New poll '"+i+"'",key:localStorage.getItem("key")}),time:new Date(_.value).getTime()})}):fetch("https://greencanyonapp.com/api/notification",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({topic:y,title:"New poll!",body:"New poll '"+i+"'",key:localStorage.getItem("key")})})}}function O(i,a,S){if(a>=0&&a<i.length){if(S==="up"&&a>0){const s=i[a];i[a]=i[a-1],i[a-1]=s}else if(S==="down"&&a<i.length-1){const s=i[a];i[a]=i[a+1],i[a+1]=s}}}return(i,a)=>{const S=ee("ion-label");return u(),h("div",pe,[l("div",_e,[he,e(t(F),null,{default:o(()=>[e(t(G),null,{default:o(()=>[e(t(I),{placeholder:"Poll Title",label:"",id:"title"}),e(t(I),{placeholder:"Poll Description",label:"",id:"desc"}),e(t(I),{placeholder:"Image Link",label:"",id:"imglink",modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=s=>r.value=s)},null,8,["modelValue"]),l("img",{src:r.value,alt:"",style:{border:"1px solid white","max-height":"165px"}},null,8,fe),ye,ve,e(t(I),{placeholder:"Button Text",label:"",id:"button",value:"Take Poll"}),me,e(t(T),{"label-placement":"fixed",class:"check",id:"schedule",modelValue:d.value,"onUpdate:modelValue":a[1]||(a[1]=s=>d.value=s)},{default:o(()=>[v("Schedule")]),_:1},8,["modelValue"]),d.value?H((u(),h("input",{key:0,type:"datetime-local",step:"1","onUpdate:modelValue":a[2]||(a[2]=s=>_.value=s)},null,512)),[[te,_.value]]):x("",!0),l("p",null,V(new Date(_.value).getTime()),1),be,ge,e(t(T),{"label-placement":"fixed",class:"check",id:"allnotif"},{default:o(()=>[v("All")]),_:1}),e(t(T),{"label-placement":"fixed",class:"check",id:"eventsnotif"},{default:o(()=>[v("Events")]),_:1}),e(t(T),{"label-placement":"fixed",class:"check",id:"gamesnotif"},{default:o(()=>[v("Games")]),_:1}),e(t(T),{"label-placement":"fixed",class:"check",id:"schedulenotif"},{default:o(()=>[v("Schedule")]),_:1})]),_:1})]),_:1}),(u(!0),h(A,null,J(n.value,s=>(u(),R(t(F),{key:s,class:"question"},{default:o(()=>[e(t(le),null,{default:o(()=>[l("button",{onClick:f=>b(s)}," X ",8,ke)]),_:2},1024),e(t(G),{ref_for:!0,ref:"poll"},{default:o(()=>[l("div",null,[l("button",{onClick:f=>O(n.value,n.value.indexOf(s),"up")},"↑",8,we),l("button",{onClick:f=>O(n.value,n.value.indexOf(s),"down")},"↓",8,Se)]),Ce,xe,l("h1",null," Question "+V(n.value.indexOf(s)+1),1),e(t(I),{placeholder:"Question Title",value:s.title},null,8,["value"]),s.type!="text"?(u(),R(t(T),{key:0,class:"required"},{default:o(()=>[v("Requires Response")]),_:1})):x("",!0),Ie,e(t(P),null,{default:o(()=>[e(S,null,{default:o(()=>[v("Question Type")]),_:1}),H(l("select",{"onUpdate:modelValue":f=>s.type=f,placeholder:"Question Type"},Ne,8,Te),[[oe,s.type]])]),_:2},1024),s.type=="radio"||s.type=="checkbox"?(u(),h("div",Ae)):x("",!0),(u(!0),h(A,null,J(s.options,f=>(u(),h("div",{key:f},[l("span",Re,[e(t(I),{placeholder:"Option",value:f.title},null,8,["value"]),l("button",{onClick:D=>k(s,f),style:{width:"25",height:"25px","font-size":"20px"}}," X ",8,De)])]))),128)),s.type=="radio"||s.type=="checkbox"?(u(),h("button",{key:2,style:{width:"20%","font-size":"20px"},onClick:f=>g(s)}," New Choice ",8,Ee)):x("",!0)]),_:2},1536)]),_:2},1024))),128)),l("button",{onClick:m}," + "),Je,Be,Ue,Le,l("button",{style:{width:"20%","font-size":"30px","margin-bottom":"15px"},onClick:w}," Create Poll ")])])}}},je=$(Me,[["__scopeId","data-v-e2e28217"]]);const ze={class:"full"},Ge={style:{color:"gray"}},He={class:"buttons full"},Fe={__name:"PollView",props:["poll"],emits:["responses"],setup(c,{emit:r}){const n=c,d=r;function _(){d("responses")}function m(k,w){confirm("Are you sure you want to delete poll "+k+"?")&&g(w)}function b(k){console.log(k.disabled),fetch("https://greencanyonapp.com/api/pollsdisable",{method:"POST",body:JSON.stringify({key:localStorage.getItem("key"),id:k.id,disabled:k.disabled!="true"}),headers:{"Content-Type":"application/json"}}).then(()=>{location.reload()})}function g(k){fetch("https://greencanyonapp.com/api/polls",{method:"DELETE",body:JSON.stringify({key:localStorage.getItem("key"),id:k}),headers:{"Content-Type":"application/json"}}).then(()=>{location.reload()})}return(k,w)=>(u(),h("div",ze,[l("h2",null,V(n.poll.title),1),l("h6",Ge,V(n.poll.desc),1),l("div",He,[e(t(P),null,{default:o(()=>[e(t(N),{onClick:_},{default:o(()=>[v("Responses")]),_:1})]),_:1}),e(t(P),null,{default:o(()=>[e(t(N),{color:n.poll.disabled=="false"||n.poll.disabled==0?"danger":"success",onClick:w[0]||(w[0]=O=>b(n.poll))},{default:o(()=>[v(V(n.poll.disabled=="false"||n.poll.disabled==0?"Disable":"Enable"),1)]),_:1},8,["color"])]),_:1}),e(t(P),null,{default:o(()=>[e(t(N),{color:"danger",onClick:w[1]||(w[1]=O=>m(n.poll.title,n.poll.id))},{default:o(()=>[v("Delete")]),_:1})]),_:1})])]))}},Xe=$(Fe,[["__scopeId","data-v-a219af73"]]);const Ke=c=>(B("data-v-bcec6473"),c=c(),U(),c),We=Ke(()=>l("h1",null," Responses ",-1)),Ye={key:0},Ze={__name:"ResponseView",props:["pollid"],setup(c){async function r(n){try{const d="https://greencanyonapp.com/api/pollsresponsescsv?pollid=".concat(n),_=await fetch(d,{headers:{key:localStorage.getItem("key")}});if(!_.ok)throw new Error("Network response was not ok.");const m=await _.blob(),b=window.URL.createObjectURL(m),g=document.createElement("a");g.href=b,g.setAttribute("download","poll_".concat(n,".csv")),document.body.appendChild(g),g.click(),g.remove(),window.URL.revokeObjectURL(b)}catch(d){console.error("Error downloading the file:",d)}}return(n,d)=>(u(),h(A,null,[We,c.pollid!=-1?(u(),h("div",Ye)):x("",!0),e(t(P),{class:"centercontent"},{default:o(()=>[e(t(N),{onClick:d[0]||(d[0]=_=>r(c.pollid))},{default:o(()=>[v("Download CSV")]),_:1})]),_:1})],64))}},Qe=$(Ze,[["__scopeId","data-v-bcec6473"]]);const et={class:"div"},tt={key:0,style:{width:"100%"}},lt={__name:"PollViewer",setup(c){const r=C([]),n=C(-1),d=async()=>{const _="https://greencanyonapp.com/api/polls?max=100&offset=0&sortbytime=1";try{const m=(await(await fetch(_,{method:"GET"})).json()).data;return console.log(m),m}catch(m){console.error(m)}return[]};return(async()=>(r.value=await d(),console.log(r.value)))(),(_,m)=>(u(),h("div",et,[e(t(X),{lines:"inset",class:"left"},{default:o(()=>[(u(!0),h(A,null,J(r.value,b=>(u(),R(t(P),{key:b},{default:o(()=>[e(Xe,{onResponses:g=>n.value=b.id,poll:b},null,8,["onResponses","poll"])]),_:2},1024))),128))]),_:1}),n.value!=-1?(u(),h("div",tt,[e(t(X),{lines:"none",class:"left centercontent"},{default:o(()=>[e(Qe,{pollid:n.value},null,8,["pollid"])]),_:1})])):x("",!0)]))}},ot=$(lt,[["__scopeId","data-v-458cd71a"]]);const W=c=>(B("data-v-b00479e2"),c=c(),U(),c),nt=W(()=>l("div",null,[l("h1",null,"Poll Manager")],-1)),st=W(()=>l("div",{class:"division"},null,-1)),at={key:0},it={key:1},ct={__name:"PollManager",setup(c){const r=C("tab2");return(n,d)=>(u(),R(t(re),null,{default:o(()=>[e(t(ce),{translucent:!0},{default:o(()=>[e(t(ne),null,{default:o(()=>[e(t(se),{slot:"start"},{default:o(()=>[e(t(ae),{color:"primary"})]),_:1}),e(t(ie),null,{default:o(()=>[v("Poll Manager")]),_:1})]),_:1})]),_:1}),e(t(ue),null,{default:o(()=>[nt,st,e(t(de),{modelValue:r.value,"onUpdate:modelValue":d[0]||(d[0]=_=>r.value=_),value:"tab2"},{default:o(()=>[e(t(K),{value:"tab2"},{default:o(()=>[v(" View Polls ")]),_:1}),e(t(K),{value:"tab1"},{default:o(()=>[v(" Create Poll ")]),_:1})]),_:1},8,["modelValue"]),r.value==="tab1"?(u(),h("div",at,[e(je)])):x("",!0),r.value==="tab2"?(u(),h("div",it,[e(ot)])):x("",!0)]),_:1})]),_:1}))}},ut=$(ct,[["__scopeId","data-v-b00479e2"]]);export{ut as default};
