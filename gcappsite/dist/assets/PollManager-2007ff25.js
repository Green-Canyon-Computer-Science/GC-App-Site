import{_ as P,r as C,a as Z,o as d,c as p,b as o,d as e,w as n,u as t,I as L,e as S,f as I,g as f,h as z,F as V,i as N,j as A,k as Q,t as $,l as w,m as x,n as ee,v as te,p as R,q as E,s as T,x as U,y as oe,z as le,A as ne,B as se,C as ae,D as ce,E as G,G as ie,H as de}from"./index-2bcf2dab.js";const r=i=>(R("data-v-4e7ae3a1"),i=i(),E(),i),ue={id:"page"},re={class:"questionContainer"},_e=r(()=>o("h2",null," Create Poll ",-1)),pe=["src"],he=r(()=>o("br",null,null,-1)),fe=r(()=>o("br",null,null,-1)),ve=r(()=>o("h1",null,"Send with notification",-1)),ye=["onClick"],me=["onClick"],ge=["onClick"],be=r(()=>o("br",null,null,-1)),ke=r(()=>o("br",null,null,-1)),we=r(()=>o("br",null,null,-1)),Se=["onUpdate:modelValue"],Ce=r(()=>o("option",{value:"text"},"Text",-1)),xe=r(()=>o("option",{value:"radio"},"Radio",-1)),Ie=r(()=>o("option",{value:"checkbox"},"Checkbox",-1)),Pe=r(()=>o("option",{value:"short"},"Short Response",-1)),qe=r(()=>o("option",{value:"long"},"Long Response",-1)),$e=[Ce,xe,Ie,Pe,qe],Te={key:1,style:{"background-color":"white",width:"80%",height:"3px"}},Ve={style:{display:"flex","flex-direction":"row"}},Ae=["onClick"],Oe=["onClick"],Ne=r(()=>o("br",null,null,-1)),Re=r(()=>o("br",null,null,-1)),Ee=r(()=>o("br",null,null,-1)),Be=r(()=>o("br",null,null,-1)),De={__name:"PollCreator",setup(i){const u=C("");C({});const c=C([]);function m(){c.value.push({title:"",options:[]})}function g(l){const s=c.value.indexOf(l);c.value.splice(s,1)}function y(l){l.options.push({title:""})}function b(l,s){l.options.splice(l.options.indexOf(s),1)}function q(){const l=document.querySelectorAll("#title")[0].value,s=document.querySelectorAll("#desc")[0].value,k=document.querySelectorAll("#button")[0].value;if(!confirm("Are you sure you want to create poll "+l+"?"))return;const a=document.querySelectorAll(".question"),h=[];a.forEach(_=>{const X=_.querySelectorAll("ion-input")[0].value,K=_.querySelectorAll("select")[0].value;let O;_.querySelectorAll(".required").length>0?O=_.querySelectorAll(".required")[0].checked:O=!1;const W=[].slice.call(_.querySelectorAll("ion-input")).splice(1),J=[];W.forEach(Y=>{J.push(Y.value)}),h.push({title:X,type:K,choices:J,required:O})}),console.log("Creating "+l+" with description "+s+" and button "+k),console.log(JSON.stringify(h)),fetch("https://greencanyonapp.com/api/polls",{method:"POST",body:JSON.stringify({timestamp:new Date().getTime()/1e3,title:l,desc:s,button:k,disabled:!1,polldata:JSON.stringify({poll:h}),image:u.value,key:localStorage.getItem("key")}),headers:{"Content-Type":"application/json"}}).then(_=>{if(!_.ok){alert("There was an error creating poll. Are you sure you have a key saved?");return}location.reload(),alert("Poll created!")}).catch(_=>{alert("An unknown error occurred.")});const B=document.querySelectorAll("#allnotif")[0].checked,D=document.querySelectorAll("#gamesnotif")[0].checked,M=document.querySelectorAll("#eventsnotif")[0].checked,j=document.querySelectorAll("#schedulenotif")[0].checked;if(B||D||M||j){let _="";B&&(_="all"),D&&(_="game"),M&&(_="event"),j&&(_="schedule"),console.log("Sending notification to "+_),fetch("https://greencanyonapp.com/api/notification",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({topic:_,title:"New poll!",body:"New poll '"+l+"'",key:localStorage.getItem("key")})})}}function v(l,s,k){if(s>=0&&s<l.length){if(k==="up"&&s>0){const a=l[s];l[s]=l[s-1],l[s-1]=a}else if(k==="down"&&s<l.length-1){const a=l[s];l[s]=l[s+1],l[s+1]=a}}}return(l,s)=>{const k=Z("ion-label");return d(),p("div",ue,[o("div",re,[_e,e(t(z),null,{default:n(()=>[e(t(L),null,{default:n(()=>[e(t(S),{placeholder:"Poll Title",label:"",id:"title"}),e(t(S),{placeholder:"Poll Description",label:"",id:"desc"}),e(t(S),{placeholder:"Image Link",label:"",id:"imglink",modelValue:u.value,"onUpdate:modelValue":s[0]||(s[0]=a=>u.value=a)},null,8,["modelValue"]),o("img",{src:u.value,alt:"",style:{border:"1px solid white","max-height":"165px"}},null,8,pe),he,e(t(S),{placeholder:"Button Text",label:"",id:"button"}),fe,ve,e(t(I),{"label-placement":"fixed",class:"check",id:"allnotif"},{default:n(()=>[f("All")]),_:1}),e(t(I),{"label-placement":"fixed",class:"check",id:"eventsnotif"},{default:n(()=>[f("Events")]),_:1}),e(t(I),{"label-placement":"fixed",class:"check",id:"gamesnotif"},{default:n(()=>[f("Games")]),_:1}),e(t(I),{"label-placement":"fixed",class:"check",id:"schedulenotif"},{default:n(()=>[f("Schedule")]),_:1})]),_:1})]),_:1}),(d(!0),p(V,null,N(c.value,a=>(d(),A(t(z),{key:a,class:"question"},{default:n(()=>[e(t(Q),null,{default:n(()=>[o("button",{onClick:h=>g(a)}," X ",8,ye)]),_:2},1024),e(t(L),{ref_for:!0,ref:"poll"},{default:n(()=>[o("div",null,[o("button",{onClick:h=>v(c.value,c.value.indexOf(a),"up")},"↑",8,me),o("button",{onClick:h=>v(c.value,c.value.indexOf(a),"down")},"↓",8,ge)]),be,ke,o("h1",null," Question "+$(c.value.indexOf(a)+1),1),e(t(S),{placeholder:"Question Title",value:a.title},null,8,["value"]),a.type!="text"?(d(),A(t(I),{key:0,class:"required"},{default:n(()=>[f("Requires Response")]),_:1})):w("",!0),we,e(t(x),null,{default:n(()=>[e(k,null,{default:n(()=>[f("Question Type")]),_:1}),ee(o("select",{"onUpdate:modelValue":h=>a.type=h,placeholder:"Question Type"},$e,8,Se),[[te,a.type]])]),_:2},1024),a.type=="radio"||a.type=="checkbox"?(d(),p("div",Te)):w("",!0),(d(!0),p(V,null,N(a.options,h=>(d(),p("div",{key:h},[o("span",Ve,[e(t(S),{placeholder:"Option",value:h.title},null,8,["value"]),o("button",{onClick:F=>b(a,h),style:{width:"25",height:"25px","font-size":"20px"}}," X ",8,Ae)])]))),128)),a.type=="radio"||a.type=="checkbox"?(d(),p("button",{key:2,style:{width:"20%","font-size":"20px"},onClick:h=>y(a)}," New Choice ",8,Oe)):w("",!0)]),_:2},1536)]),_:2},1024))),128)),o("button",{onClick:m}," + "),Ne,Re,Ee,Be,o("button",{style:{width:"20%","font-size":"30px","margin-bottom":"15px"},onClick:q}," Create Poll ")])])}}},Me=P(De,[["__scopeId","data-v-4e7ae3a1"]]);const je={class:"full"},Je={style:{color:"gray"}},Le={class:"buttons full"},ze={__name:"PollView",props:["poll"],emits:["responses"],setup(i,{emit:u}){const c=i,m=u;function g(){m("responses")}function y(v,l){confirm("Are you sure you want to delete poll "+v+"?")&&q(l)}function b(v){console.log(v.disabled),fetch("https://greencanyonapp.com/api/pollsdisable",{method:"POST",body:JSON.stringify({key:localStorage.getItem("key"),id:v.id,disabled:v.disabled!="true"}),headers:{"Content-Type":"application/json"}}).then(()=>{location.reload()})}function q(v){fetch("https://greencanyonapp.com/api/polls",{method:"DELETE",body:JSON.stringify({key:localStorage.getItem("key"),id:v}),headers:{"Content-Type":"application/json"}}).then(()=>{location.reload()})}return(v,l)=>(d(),p("div",je,[o("h2",null,$(c.poll.title),1),o("h6",Je,$(c.poll.desc),1),o("div",Le,[e(t(x),null,{default:n(()=>[e(t(T),{onClick:g},{default:n(()=>[f("Responses")]),_:1})]),_:1}),e(t(x),null,{default:n(()=>[e(t(T),{onClick:l[0]||(l[0]=s=>b(c.poll))},{default:n(()=>[f($(c.poll.disabled=="false"?"Disable":"Enable"),1)]),_:1})]),_:1}),e(t(x),null,{default:n(()=>[e(t(T),{color:"danger",onClick:l[1]||(l[1]=s=>y(c.poll.title,c.poll.id))},{default:n(()=>[f("Delete")]),_:1})]),_:1})])]))}},Ue=P(ze,[["__scopeId","data-v-c5ef7dc8"]]);const Ge=i=>(R("data-v-5c78849c"),i=i(),E(),i),He=Ge(()=>o("h1",null," Responses ",-1)),Fe={key:0},Xe={__name:"ResponseView",props:["pollid"],setup(i){return(u,c)=>(d(),p(V,null,[He,i.pollid!=-1?(d(),p("div",Fe)):w("",!0),e(t(x),{class:"centercontent"},{default:n(()=>[e(t(T),{href:"https://greencanyonapp.com/api/pollsresponsescsv?pollid="+i.pollid,download:"poll_"+i.pollid+".csv"},{default:n(()=>[f("Download CSV")]),_:1},8,["href","download"])]),_:1})],64))}},Ke=P(Xe,[["__scopeId","data-v-5c78849c"]]);const We={class:"div"},Ye={key:0,style:{width:"100%"}},Ze={__name:"PollViewer",setup(i){const u=C([]),c=C(-1),m=async()=>{const g="https://greencanyonapp.com/api/polls?max=100&offset=0&sortbytime=1";try{const y=(await(await fetch(g,{method:"GET"})).json()).data;return console.log(y),y}catch(y){console.error(y)}return[]};return(async()=>(u.value=await m(),console.log(u.value)))(),(g,y)=>(d(),p("div",We,[e(t(U),{lines:"inset",class:"left"},{default:n(()=>[(d(!0),p(V,null,N(u.value,b=>(d(),A(t(x),{key:b},{default:n(()=>[e(Ue,{onResponses:q=>c.value=b.id,poll:b},null,8,["onResponses","poll"])]),_:2},1024))),128))]),_:1}),c.value!=-1?(d(),p("div",Ye,[e(t(U),{lines:"none",class:"left centercontent"},{default:n(()=>[e(Ke,{pollid:c.value},null,8,["pollid"])]),_:1})])):w("",!0)]))}},Qe=P(Ze,[["__scopeId","data-v-458cd71a"]]);const H=i=>(R("data-v-b00479e2"),i=i(),E(),i),et=H(()=>o("div",null,[o("h1",null,"Poll Manager")],-1)),tt=H(()=>o("div",{class:"division"},null,-1)),ot={key:0},lt={key:1},nt={__name:"PollManager",setup(i){const u=C("tab2");return(c,m)=>(d(),A(t(de),null,{default:n(()=>[e(t(ae),{translucent:!0},{default:n(()=>[e(t(oe),null,{default:n(()=>[e(t(le),{slot:"start"},{default:n(()=>[e(t(ne),{color:"primary"})]),_:1}),e(t(se),null,{default:n(()=>[f("Poll Manager")]),_:1})]),_:1})]),_:1}),e(t(ie),null,{default:n(()=>[et,tt,e(t(ce),{modelValue:u.value,"onUpdate:modelValue":m[0]||(m[0]=g=>u.value=g),value:"tab2"},{default:n(()=>[e(t(G),{value:"tab2"},{default:n(()=>[f(" View Polls ")]),_:1}),e(t(G),{value:"tab1"},{default:n(()=>[f(" Create Poll ")]),_:1})]),_:1},8,["modelValue"]),u.value==="tab1"?(d(),p("div",ot,[e(Me)])):w("",!0),u.value==="tab2"?(d(),p("div",lt,[e(Qe)])):w("",!0)]),_:1})]),_:1}))}},at=P(nt,[["__scopeId","data-v-b00479e2"]]);export{at as default};
